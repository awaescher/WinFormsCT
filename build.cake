//////////////////////////////////////////////////////////////////////
// ARGUMENTS
//////////////////////////////////////////////////////////////////////

var target = Argument("target", "Default");
var configuration = Argument("configuration", "Release");

//////////////////////////////////////////////////////////////////////
// PREPARATION
//////////////////////////////////////////////////////////////////////

// Define directories.
var outputDirectory = Directory("_out");

//////////////////////////////////////////////////////////////////////
// TASKS
//////////////////////////////////////////////////////////////////////

Task("Clean")
    .Does(() =>
		{
			CleanDirectory(outputDirectory);
		});
		
Task("Build")
    .IsDependentOn("Clean")
    .Does(() =>
		{
		  // Use MSBuild
		  MSBuild("WinFormsCT.sln", settings =>
			settings.SetConfiguration(configuration));
		});
		
Task("Pack")
    .IsDependentOn("Build")
    .Does(() =>
		{

			var NuGetPackSettings = new NuGetPackSettings
			{
				OutputDirectory = outputDirectory,
				Version = "1.0",
				IncludeReferencedProjects = true,
				Properties = new Dictionary<string, string>
				{
					{ "Configuration", "Release" }
				}
			};

			NuGetPack("WinFormsCT.nuspec", NuGetPackSettings);
			
		});
		

//////////////////////////////////////////////////////////////////////
// TASK TARGETS
//////////////////////////////////////////////////////////////////////

Task("Default")
    .IsDependentOn("Pack");

//////////////////////////////////////////////////////////////////////
// EXECUTION
//////////////////////////////////////////////////////////////////////

RunTarget(target);